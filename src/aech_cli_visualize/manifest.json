{
  "spec_version": 5,
  "name": "visualize",
  "type": "cli",
  "command": "aech-cli-visualize",
  "description": "Render charts, KPIs, tables, and dashboards to presentation-ready images. Input: JSON data or specification files. Output: PNG/SVG/PDF images sized for presentations (16:9 aspect ratio by default). Includes data analysis for dashboard recommendations and config repository for reusable templates.",
  "bundled_skills": [
    {
      "name": "dashboard-designer",
      "description": "Interactive dashboard design workflow. Analyzes data, asks clarifying questions, generates visualizations, and saves reusable configs. Use when user has raw data and wants a dashboard created collaboratively."
    }
  ],
  "actions": [
    {
      "name": "chart",
      "description": "Render a chart from data. Input: JSON with x/y values or series data, via file or stdin. Output: chart image at <output-dir>/chart.<format>. Use when user needs a visual chart from numeric data.",
      "parameters": [
        {
          "name": "chart_type",
          "type": "argument",
          "required": true,
          "description": "Chart type. Values: bar, line, pie, scatter, area, heatmap."
        },
        {
          "name": "data_file",
          "type": "argument",
          "required": false,
          "description": "Path to JSON data file. If omitted, reads from stdin."
        },
        {
          "name": "output-dir",
          "type": "option",
          "required": true,
          "description": "Directory where output image will be written."
        },
        {
          "name": "title",
          "type": "option",
          "required": false,
          "description": "Chart title displayed at top."
        },
        {
          "name": "theme",
          "type": "option",
          "required": false,
          "description": "Visual theme. Values: corporate, modern, minimal, dark, light. Default: corporate."
        },
        {
          "name": "format",
          "type": "option",
          "required": false,
          "description": "Output format. Values: png, svg, pdf. Default: png."
        }
      ]
    },
    {
      "name": "kpi",
      "description": "Render a KPI metric card. Input: value and label via options. Output: KPI card image at <output-dir>/kpi.<format>. Use when user needs to highlight a key metric with optional trend indicator.",
      "parameters": [
        {
          "name": "value",
          "type": "option",
          "required": true,
          "description": "The metric value to display. Can be number or string."
        },
        {
          "name": "label",
          "type": "option",
          "required": true,
          "description": "Label describing the metric (e.g., 'Active Users', 'Revenue')."
        },
        {
          "name": "output-dir",
          "type": "option",
          "required": true,
          "description": "Directory where output image will be written."
        },
        {
          "name": "delta",
          "type": "option",
          "required": false,
          "description": "Change indicator (e.g., '+12%', '-5'). Colored green/red based on delta-good."
        },
        {
          "name": "delta-good",
          "type": "option",
          "required": false,
          "description": "Whether positive delta is good. Values: true, false. Default: true. Use --delta-good or --delta-bad."
        },
        {
          "name": "format-value",
          "type": "option",
          "required": false,
          "description": "Python format string for value. Examples: {:,.0f} for thousands, ${:,.2f} for currency."
        },
        {
          "name": "theme",
          "type": "option",
          "required": false,
          "description": "Visual theme. Values: corporate, modern, minimal, dark, light. Default: corporate."
        },
        {
          "name": "format",
          "type": "option",
          "required": false,
          "description": "Output format. Values: png, svg, pdf. Default: png."
        }
      ]
    },
    {
      "name": "table",
      "description": "Render a data table as an image. Input: JSON with headers and rows, via file or stdin. Output: table image at <output-dir>/table.<format>. Use when user needs tabular data as a shareable image.",
      "parameters": [
        {
          "name": "data_file",
          "type": "argument",
          "required": false,
          "description": "Path to JSON file with headers/rows. If omitted, reads from stdin."
        },
        {
          "name": "output-dir",
          "type": "option",
          "required": true,
          "description": "Directory where output image will be written."
        },
        {
          "name": "title",
          "type": "option",
          "required": false,
          "description": "Table title displayed above."
        },
        {
          "name": "theme",
          "type": "option",
          "required": false,
          "description": "Visual theme. Values: corporate, modern, minimal, dark, light. Default: corporate."
        },
        {
          "name": "format",
          "type": "option",
          "required": false,
          "description": "Output format. Values: png, svg, pdf. Default: png."
        }
      ]
    },
    {
      "name": "gauge",
      "description": "Render a gauge indicator. Input: value and range via options. Output: gauge image at <output-dir>/gauge.<format>. Use when user needs to show progress or status against a target.",
      "parameters": [
        {
          "name": "value",
          "type": "option",
          "required": true,
          "description": "Current value to display on gauge."
        },
        {
          "name": "output-dir",
          "type": "option",
          "required": true,
          "description": "Directory where output image will be written."
        },
        {
          "name": "min",
          "type": "option",
          "required": false,
          "description": "Minimum gauge value. Default: 0."
        },
        {
          "name": "max",
          "type": "option",
          "required": false,
          "description": "Maximum gauge value. Default: 100."
        },
        {
          "name": "label",
          "type": "option",
          "required": false,
          "description": "Label describing the metric."
        },
        {
          "name": "thresholds",
          "type": "option",
          "required": false,
          "description": "JSON array of threshold objects [{\"value\": 50, \"color\": \"red\", \"label\": \"Low\"}] for colored zones."
        },
        {
          "name": "theme",
          "type": "option",
          "required": false,
          "description": "Visual theme. Values: corporate, modern, minimal, dark, light. Default: corporate."
        },
        {
          "name": "format",
          "type": "option",
          "required": false,
          "description": "Output format. Values: png, svg, pdf. Default: png."
        }
      ]
    },
    {
      "name": "dashboard",
      "description": "Compose multiple widgets into a single dashboard image. Input: JSON specification with layout and widgets, via file or stdin. Output: dashboard image at <output-dir>/dashboard.<format>. Use when user needs a complete dashboard view with multiple metrics and charts.",
      "parameters": [
        {
          "name": "spec_file",
          "type": "argument",
          "required": false,
          "description": "Path to dashboard specification JSON. If omitted, reads from stdin."
        },
        {
          "name": "output-dir",
          "type": "option",
          "required": true,
          "description": "Directory where output image will be written."
        },
        {
          "name": "theme",
          "type": "option",
          "required": false,
          "description": "Visual theme applied to all widgets. Values: corporate, modern, minimal, dark, light. Default: corporate."
        },
        {
          "name": "resolution",
          "type": "option",
          "required": false,
          "description": "Output resolution. Values: 1080p (1920x1080), 4k (3840x2160), or WxH (e.g., 1280x720). Default: 1080p."
        },
        {
          "name": "format",
          "type": "option",
          "required": false,
          "description": "Output format. Values: png, svg, pdf. Default: png."
        }
      ]
    },
    {
      "name": "analyze",
      "description": "Analyze data to suggest visualizations and generate clarifying questions. Input: JSON data via file or stdin. Output: field analysis, detected patterns, widget suggestions, optional questions, matching configs. Use when starting dashboard design to understand the data.",
      "parameters": [
        {
          "name": "data_file",
          "type": "argument",
          "required": false,
          "description": "Path to JSON data file. If omitted, reads from stdin."
        },
        {
          "name": "questions",
          "type": "option",
          "required": false,
          "description": "Include clarifying questions in output. Default: true. Use --questions or --no-questions."
        },
        {
          "name": "llm",
          "type": "option",
          "required": false,
          "description": "Use LLM for enhanced analysis. Default: true. Use --llm or --no-llm."
        }
      ]
    },
    {
      "name": "config save",
      "description": "Save a dashboard specification to the config repository for future reuse. Input: dashboard spec via file or stdin. Output: saved config metadata. Use after creating a dashboard the user wants to reuse.",
      "parameters": [
        {
          "name": "name",
          "type": "option",
          "required": true,
          "description": "Unique name for the config. Use lowercase with hyphens (e.g., quarterly-sales)."
        },
        {
          "name": "spec_file",
          "type": "argument",
          "required": false,
          "description": "Path to dashboard spec JSON. If omitted, reads from stdin."
        },
        {
          "name": "tags",
          "type": "option",
          "required": false,
          "description": "Comma-separated tags for categorization (e.g., sales,executive,quarterly)."
        },
        {
          "name": "description",
          "type": "option",
          "required": false,
          "description": "Human-readable description of what this dashboard shows."
        }
      ]
    },
    {
      "name": "config list",
      "description": "List saved dashboard configurations. Output: JSON array of config metadata. Use to show user available saved dashboards.",
      "parameters": [
        {
          "name": "tags",
          "type": "option",
          "required": false,
          "description": "Filter by tags. Comma-separated (e.g., sales,executive)."
        },
        {
          "name": "limit",
          "type": "option",
          "required": false,
          "description": "Maximum configs to return. Default: 20."
        }
      ]
    },
    {
      "name": "config get",
      "description": "Retrieve a saved dashboard configuration by name or ID. Output: config metadata and full spec. Use when user wants to reuse a saved dashboard.",
      "parameters": [
        {
          "name": "name_or_id",
          "type": "argument",
          "required": true,
          "description": "Config name or UUID to retrieve."
        }
      ]
    },
    {
      "name": "config match",
      "description": "Find saved configs that match data schema. Input: JSON data via file or stdin. Output: matching configs ranked by relevance. Use when user provides data to suggest reusable templates.",
      "parameters": [
        {
          "name": "data_file",
          "type": "argument",
          "required": false,
          "description": "Path to JSON data file. If omitted, reads from stdin."
        },
        {
          "name": "limit",
          "type": "option",
          "required": false,
          "description": "Maximum matches to return. Default: 5."
        }
      ]
    },
    {
      "name": "config delete",
      "description": "Delete a saved configuration from the repository. Use when user wants to remove an old or unused dashboard template.",
      "parameters": [
        {
          "name": "name_or_id",
          "type": "argument",
          "required": true,
          "description": "Config name or UUID to delete."
        }
      ]
    },
    {
      "name": "iterate",
      "description": "Iterate on a dashboard based on user feedback. Uses LLM to interpret feedback like 'fonts too small' or 'too crowded' and modifies the spec accordingly. Outputs new render and optionally saves modified spec. Use when user wants to refine a dashboard's appearance.",
      "parameters": [
        {
          "name": "spec_file",
          "type": "argument",
          "required": false,
          "description": "Path to dashboard spec JSON. If omitted, reads from stdin."
        },
        {
          "name": "feedback",
          "type": "option",
          "required": true,
          "description": "User feedback to apply (e.g., 'fonts too small', 'too crowded', 'need more spacing')."
        },
        {
          "name": "previous-image",
          "type": "option",
          "required": false,
          "description": "Path to previous render for visual context. Helps LLM understand current state."
        },
        {
          "name": "output-dir",
          "type": "option",
          "required": true,
          "description": "Directory where output image and spec will be written."
        },
        {
          "name": "theme",
          "type": "option",
          "required": false,
          "description": "Visual theme. Values: corporate, modern, minimal, dark, light. Default: corporate."
        },
        {
          "name": "format",
          "type": "option",
          "required": false,
          "description": "Output format. Values: png, svg, pdf. Default: png."
        },
        {
          "name": "save-spec",
          "type": "option",
          "required": false,
          "description": "Save modified spec to output dir. Default: true. Use --save-spec or --no-save-spec."
        }
      ]
    }
  ],
  "available_in_sandbox": true,
  "documentation": {
    "outputs": {
      "chart_image": {
        "path": "<output-dir>/chart.<format>",
        "description": "Rendered chart image"
      },
      "kpi_image": {
        "path": "<output-dir>/kpi.<format>",
        "description": "Rendered KPI card image"
      },
      "table_image": {
        "path": "<output-dir>/table.<format>",
        "description": "Rendered table image"
      },
      "gauge_image": {
        "path": "<output-dir>/gauge.<format>",
        "description": "Rendered gauge image"
      },
      "dashboard_image": {
        "path": "<output-dir>/dashboard.<format>",
        "description": "Composed dashboard image"
      }
    },
    "notes": [
      "All commands return JSON to stdout with output file paths",
      "Default aspect ratio is 16:9 for presentation compatibility",
      "Themes: corporate (blue/gray), modern (vibrant), minimal (B&W), dark, light",
      "Data for charts: {\"x\": [...], \"y\": [...]} or {\"x\": [...], \"series\": [{\"name\": \"...\", \"values\": [...]}]}",
      "Data for tables: {\"headers\": [...], \"rows\": [[...], [...]]}}",
      "Style section in spec: {\"style\": {\"preset\": \"presentation\", \"font_scale\": 1.4, \"h_spacing\": 0.08, \"v_spacing\": 0.10}}",
      "Style presets: compact (small fonts/tight), default, presentation (large fonts/spacious), spacious",
      "Use iterate command to refine dashboards based on natural language feedback"
    ],
    "quality_assurance": {
      "description": "CRITICAL: You MUST visually review every rendered dashboard before returning to user. Do not return images without QA.",
      "design_principles": {
        "visual_hierarchy": "Elements should have size proportional to importance. KPIs are hero elements and should dominate. Charts should fill their space generously.",
        "spatial_balance": "Every pixel should feel intentional. Wasted empty space is as bad as cramping. Widgets should fill 80-90% of their allocated regions.",
        "typography": "All text must be readable at presentation distance."
      },
      "process": [
        "1. Render dashboard with initial spec (use preset: presentation for best defaults)",
        "2. View the rendered image and check for visual balance",
        "3. If issues found, call iterate with natural language feedback describing what's wrong",
        "4. Repeat until acceptable (max 3 iterations)",
        "5. Return final result to user"
      ],
      "checklist": [
        "Visual balance: no huge empty areas, no cramped widgets",
        "Text readable at presentation distance",
        "No widget overlap or cramping",
        "Delta indicators visible on KPIs",
        "Chart axis labels readable",
        "Adequate spacing between widgets",
        "Titles and labels not truncated",
        "Widgets fill their allocated space",
        "Top row positioned well relative to title"
      ],
      "iterate_feedback_examples": {
        "fonts_too_small": "fonts too small to read",
        "widgets_cramped": "widgets overlapping",
        "gauge_tiny": "gauge is tiny",
        "empty_space_at_top": "too much space between title and content",
        "top_row_too_low": "move top row closer to title",
        "charts_too_close": "need more spacing between charts",
        "poor_balance": "poor visual balance - [describe what's wrong]"
      },
      "important": "Describe VISUAL problems in plain language. The iterate command's internal agent handles all parameter calculations automatically."
    }
  }
}
